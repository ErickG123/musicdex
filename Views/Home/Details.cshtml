@using musicdex.Models
@model Musica

@{
    ViewData["Title"] = Model?.Titulo ?? "Detalhes";
}

<style>
    body {
        background: #121212;
        color: #fff;
    }

    .details-page {
        padding: 2rem;
        display: flex;
        gap: 2rem;
        align-items: flex-start;
    }

    .cover-large {
        width: 320px;
        height: 320px;
        border-radius: 12px;
        object-fit: cover;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.7);
    }

    .info {
        max-width: 760px;
    }

    .title {
        font-size: 2rem;
        font-weight: 800;
        margin-bottom: 6px;
    }

    .artist {
        color: #b3b3b3;
        margin-bottom: 1rem;
        font-size: 1.05rem;
    }

    .meta {
        display: flex;
        gap: 1rem;
        color: #b3b3b3;
        margin-bottom: 1rem;
    }

    .cta {
        display: flex;
        gap: .8rem;
        margin-top: 1rem;
    }

    .btn-play {
        background: #1DB954;
        border: none;
        color: #000;
        padding: .6rem 1.1rem;
        border-radius: 999px;
        font-weight: 700;
        cursor: pointer;
    }

    .btn-secondary {
        background: transparent;
        border: 1px solid rgba(255, 255, 255, 0.08);
        color: #fff;
        padding: .5rem .9rem;
        border-radius: 999px;
        cursor: pointer;
    }

    .description {
        margin-top: 1.25rem;
        line-height: 1.5;
        color: #d0d0d0;
    }
</style>

<div class="details-page container">
    <div>
        @{
            var imgSrc = !string.IsNullOrWhiteSpace(Model?.ImagemBase64)
            ? (Model.ImagemBase64.StartsWith("http", StringComparison.OrdinalIgnoreCase) ||
            Model.ImagemBase64.StartsWith("data:", StringComparison.OrdinalIgnoreCase)
            ? Model.ImagemBase64
            : "data:image/jpeg;base64," + Model.ImagemBase64)
            : Url.Content("~/images/cover-placeholder.png");
        }
        <img src="@imgSrc" alt="@Model?.Titulo" class="cover-large" />
    </div>

    <div class="info">
        <div class="title">@Model?.Titulo</div>
        <div class="artist">@Model?.Artista @if(!string.IsNullOrEmpty(Model?.Album)){
        <text>• @Model.Album</text>
                }
</div>

        <div class="meta">
            @if (Model?.Lancamento != null)
            {
                <div>Lançamento: @Model.Lancamento</div>
            }
            @if (Model?.DuracaoSegundos != null)
            {
                <div>Duração: @(TimeSpan.FromSeconds(Model.DuracaoSegundos).ToString(@"m\:ss"))</div>
            }
            @if (Model?.Genero != null)
            {
                <div>Gênero: @Model.Genero.Nome</div>
            }
        </div>

        <div class="cta">
            <button class="btn-play" id="btnPlay">▶ Play</button>
            <button class="btn-secondary" id="btnSave">Salvar</button>
            <a class="btn-secondary" href="@Url.Action("Index", "Home")">Voltar</a>
        </div>

        <div class="description">
            @if (!string.IsNullOrWhiteSpace(Model?.Descricao))
            {
                @Html.Raw(Model.Descricao)
            }
            else
            {
                <p class="text-muted">Sem descrição disponível para esta faixa.</p>
            }
        </div>
    </div>
</div>

<script>
    document.getElementById('btnPlay')?.addEventListener('click', function () {
        alert('Play: neste exemplo não há preview. Integre uma URL de áudio ou player para tocar.');
    });

    document.getElementById('btnSave')?.addEventListener('click', function () {
        alert('Salvar: implemente aqui a chamada AJAX para favoritar/guardar a música.');
    });
</script>
